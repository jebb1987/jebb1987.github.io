<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Cardas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f8f8f8;
            margin: 0;
            padding: 10px;
        }

        h1 {
            color: #333;
            font-size: 22px;
            margin-bottom: 20px;
        }

        table {
            width: 90%;
            max-width: 1000px;
            margin: 20px auto;
            border-collapse: collapse;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }

        th {
            background-color: #4CAF50;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .btn-back {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-decoration: none;
            margin-top: 20px;
            display: inline-block;
        }

        .btn-back:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

    <h1>Reporte de Cardas</h1>

    <div id="table-container">
        <!-- Aquí se cargará la tabla dinámicamente -->
    </div>

    <a href="index.html" class="btn-back">Volver al Menú Principal</a>

    <script>
        // URL del archivo CSV publicado
        const csvUrl = "https://docs.google.com/spreadsheets/d/1ym-WMD62LXlz0C0VTZmZN7Hzzk56Fdh7/export?format=csv";

        // Función para cargar y mostrar los datos del CSV
        async function loadTable() {
            try {
                const response = await fetch(csvUrl);
                const csvData = await response.text();

                // Parsear el CSV a un array de filas
                const rows = csvData.split("\n").filter(row => row.trim() !== ""); // Eliminar filas vacías

                // Crear la tabla HTML
                let table = "<table>";
                table += "<thead><tr>";

                // Procesar la primera fila como encabezados
                const headers = rows[0].split(",");
                headers.forEach(header => {
                    table += `<th>${header.trim()}</th>`;
                });
                table += "</tr></thead><tbody>";

                // Procesar las filas de datos
                for (let i = 1; i < rows.length; i++) {
                    const values = rows[i].split(",");
                    table += "<tr>";
                    values.forEach(value => {
                        table += `<td>${value.trim() === "" ? "-" : value.trim()}</td>`; // Mostrar "-" si la celda está vacía
                    });
                    table += "</tr>";
                }

                table += "</tbody></table>";

                // Insertar la tabla en el contenedor
                document.getElementById("table-container").innerHTML = table;
            } catch (error) {
                console.error("Error al cargar los datos:", error);
                document.getElementById("table-container").innerHTML = "<p>Error al cargar los datos. Por favor, inténtalo de nuevo más tarde.</p>";
            }
        }

        // Cargar la tabla al abrir la página
        loadTable();
    </script>
</body>
</html>